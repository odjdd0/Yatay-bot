from aiogram import Dispatcher
from aiogram.types import Message
from aiogram.dispatcher import FSMContext
from keyboards import get_main_keyboard
from database import add_user, update_user_last_active

async def send_menu(message: Message, state: FSMContext = None):
    if state:
        await state.finish()
    user_id = message.from_user.id
    add_user(user_id)
    update_user_last_active(user_id)
    await message.answer(
        "üì´–í–∞—Å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É–µ—Ç YATAY POIZON, –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫ –ø–æ–∫—É–ø–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ —Å –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ Poizon)",
        reply_markup=get_main_keyboard()
    )

async def handle_info(message: Message):
    if message.text == '–û –Ω–∞—Åüìë':
        await message.answer(
            "‚ù§Ô∏è‚Äç–ú—ã ‚Äî YATAY INTERNATIONAL, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –æ–ø–ª–∞—Ç—É –∏ –¥–æ—Å—Ç–∞–≤–∫—É –≤–∞—à–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ Poizon –∏ 95!\n"
            "ü§ñ–ù–∞—à –±–æ—Ç –ø–æ–º–æ–∂–µ—Ç –≤–∞–º —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ç–æ–≤–∞—Ä —Å –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞ POIZON –∏ 95‚ùóÔ∏è\n"
            "üìâ–£ –Ω–∞—Å —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π –∫—É—Ä—Å –∏ —Å–∞–º–∞—è –±—ã—Å—Ç—Ä–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞‚ôªÔ∏è\n"
            "üîí–ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ –∏ –≥–∞—Ä–∞–Ω—Ç–∏–∏ –Ω–∞ –≤–∞—à —Ç–æ–≤–∞—Äüå±\n"
            "üìÆ–£ –Ω–∞—Å —É–¥–æ–±–Ω–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∏ –ª—É—á—à–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ãü§ù\n"
            "üìç–ú—ã –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –¢–æ–º—Å–∫–µ, –Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ –≤—Å–µ–π –†–æ—Å—Å–∏–∏‚ùóÔ∏è\n"
            "‚ù§Ô∏è–ú—ã –≤—Å–µ–≥–¥–∞ —Ä–∞–¥—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—è–ºüåπ"
            "‚úÖ–ù–∞—à –∫–∞–Ω–∞–ª: https://t.me/YATAYPOIZON\n"
            #"üì±–û—Å–Ω–æ–≤–Ω–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä: @ttt777788\n"
            "üìû–ú–µ–Ω–µ–¥–∂–µ—Ä: @promoutermuhamad\n"
            "‚òéÔ∏è–¢–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∞: @Episthema",
            reply_markup=get_main_keyboard()
        )
    elif message.text == '–î–æ—Å—Ç–∞–≤–∫–∞üì¶':
        await message.answer(
            "–ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Ç—Ä–∏ –≤–∏–¥–∞ –¥–æ—Å—Ç–∞–≤–∫–∏:\n"
            "1) –°–∞–º–∞—è –î–µ—à—ë–≤–∞—è –î–æ—Å—Ç–∞–≤–∫–∞\n"
            "–î–æ—Å—Ç–∞–≤–∫–∞ –ø—É—Ç—ë–º –∫–∞—Ä–≥–æ. –ú—ã –≤–æ–∑–∏–º –ø—É–ª–æ–º, –∏–∑-–∑–∞ —á–µ–≥–æ —Ü–µ–Ω—ã –º–∏–Ω–∏–º–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è, –Ω–æ —É–º–µ–Ω—å—à–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å\n"
            "–¶–µ–Ω–∞: 40 —é–∞–Ω–µ–π –∑–∞ –∫–≥ (–ø–æ–¥—Å—á—ë—Ç –≤ –±–æ—Ç–µ –ø–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É –∫—É—Ä—Å—É)\n"
            "–°—Ä–æ–∫–∏: 3-6 –Ω–µ–¥–µ–ª—å\n\n"
            "2) –ë—ã—Å—Ç—Ä–∞—è –î–æ—Å—Ç–∞–≤–∫–∞\n"
            "–î–æ—Å—Ç–∞–≤–∫–∞ –Ω–∞ —Å–∞–º–æ–ª—ë—Ç–µ. –¶–µ–Ω–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ, –Ω–æ —Å–∫–æ—Ä–æ—Å—Ç—å –¥–æ—Å—Ç–∞–≤–∫–∏ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è\n"
            "–¶–µ–Ω–∞: 170 —é–∞–Ω–µ–π –∑–∞ –∫–≥ (–ø–æ–¥—Å—á—ë—Ç –≤ –±–æ—Ç–µ –ø–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É –∫—É—Ä—Å—É)\n"
            "–°—Ä–æ–∫–∏: 1-2 –Ω–µ–¥–µ–ª–∏\n\n"
            "3) –°–∞–º–∞—è –ë—ã—Å—Ç—Ä–∞—è –î–æ—Å—Ç–∞–≤–∫–∞\n"
            "–ú—ã –ø–µ—Ä–µ–¥–∞—ë–º –≤–∞—à –∑–∞–∫–∞–∑ –≤ —Ä—É–∫–∏ –Ω–∞—à–µ–≥–æ –¥–æ—Å—Ç–∞–≤—â–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–ø—Ä—è–º—É—é –≤ —Å–∞–º—ã–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Ä–æ–∫–∏ –¥–æ–±–∏—Ä–∞–µ—Ç—Å—è –¥–æ –ú–æ—Å–∫–≤—ã. –î–∞–ª—å—à–µ –ø–æ—Å—ã–ª–∫–∞ –æ—Ç–ø—Ä–∞–≤–∏—Ç—Å—è –∫ –≤–∞–º –ø–æ –†–æ—Å—Å–∏–∏\n"
            "–¶–µ–Ω–∞: 205 —é–∞–Ω–µ–π –∑–∞ –∫–≥ (–ø–æ–¥—Å—á—ë—Ç –≤ –±–æ—Ç–µ –ø–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É –∫—É—Ä—Å—É) + –¥–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –†–æ—Å—Å–∏–∏\n"
            "–°—Ä–æ–∫–∏: –¥–æ –æ–¥–Ω–æ–π –Ω–µ–¥–µ–ª–∏\n\n"
            "–î–æ—Å—Ç–∞–≤–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –¥–æ –¢–æ–º—Å–∫–∞, –æ—Ç–∫—É–¥–∞ –¥–∞–ª—å—à–µ –º—ã –≤–∞–º –ø–µ—Ä–µ–¥–∞–¥–∏–º –ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º (–æ–ø–ª–∞—á–∏–≤–∞–µ—Ç—Å—è –∑–∞ –≤–∞—à —Å—á—ë—Ç)\n"
            "–û –¥–æ—Å—Ç–∞–≤–∫–µ –∞–∫—Å–µ—Å—Å—É–∞—Ä–æ–≤ –∏ —Ç–µ—Ö–Ω–∏–∫–∏ –¥–æ–≥–æ–≤–∞—Ä–∏–≤–∞–π—Ç–µ—Å—å —Å –Ω–∞—à–∏–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º –Ω–∞–ø—Ä—è–º—É—é.\n"
            "–ú—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ (—É—Å–ª–æ–≤–∏–µ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∞–º–æ–≥–æ –∑–∞–∫–∞–∑–∞. –ó–∞ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ—Å—Ç—å –º—ã –Ω–µ –Ω–µ—Å—ë–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å).\n"
            "–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å —É—Å–ª—É–≥–∏ –∏ —Å—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏—è 500 —Ä—É–±–ª–µ–π.\n\n"
            "–ï—Å–ª–∏ —É –≤–∞—Å –æ—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å—Ç–∞—Ä—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É: @promoutermuhamad",
            reply_markup=get_main_keyboard()
        )

# async def handle_reviews(message: Message):
#     await message.answer(
#         "https://t.me/yatayreviews\n"
#         "–û—Ç–∑—ã–≤—ã –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –Ω–∞—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É: @ttt777788"
#     )

def register_start_handlers(dp: Dispatcher):
    dp.register_message_handler(send_menu, commands=['start'], state='*')
    dp.register_message_handler(handle_info, lambda message: message.text in ["–û –Ω–∞—Åüìë", "–î–æ—Å—Ç–∞–≤–∫–∞üì¶"])
    #dp.register_message_handler(handle_reviews, lambda message: message.text == '–û—Ç–∑—ã–≤—ã –∏ –≤—ã–∫—É–ø—ãüìì')